<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    {% load static %}
    <title>Profile page</title>
    <link rel="stylesheet"  href="{% static 'css/style.css' %}">
</head>
<body>
   <nav class="navbar">
    <div class="navbar-left">
        {% load static %}
        <a href="index.html" class="logo"><img src="{% static 'img/start.jpg' %}"></a>
        <div class="searchbox">
            <img src="{% static 'img/search.png' %}">
            <input type="text" placeholder="Search">
        </div>
    </div>
    <div class="navbar-center">
        <ul>
            <li class="notification-icon">
                <a href="#" id="notification-button">
                    <img src="{% static 'img/bell.png' %}">
                    <span>Notifications</span>
                </a>
                <!-- Всплывающее окно с уведомлениями -->
                <div id="notification-popup" class="notification-popup">
                    <h4>Notifications</h4>
                    <ul>
                        <li><a href="#">New friend request</a></li>
                        <li><a href="#">Message from John</a></li>
                        <li><a href="#">Your post got a like!</a></li>
                    </ul>
                </div>
            </li>
        </ul>
    </div>
    <div class="navbar-right">
        <img src="{% static 'img/start.jpg' %}" class="nav-profile-img" onclick="toggleMenu()">
    </div>
    <div class="profile-menu-wrap" id="profileMenu">
        <div class="profile-menu">
            <div class="user-info">
                <img src="{% static 'img/start.jpg' %}" alt="">
                <div>
                    <h3><a href="#" class="profile-menu-links">Username</a></h3>
                </div>
            </div>
            <a href="#" class="profile-menu-links">
                <img src="{% static 'img/settings.png' %}" alt="">
                <p>Settings</p>
            </a>
            <a href="#" class="profile-menu-links">
                <img src="{% static 'img/logout.png' %}" alt="">
                <p>Logout</p>
            </a>
        </div>
    </div>

   </nav>
   <div class="container">
    <div class="main">
        <div class="profile-header">
            <div class="profile-background"></div>
            <img src="{{user.profile.image.url}}" alt="Profile Picture" class="profile-pic">
            <div class="profile-info">
                <h2>{{user.username}}</h2>
                {% if user.profile.location != "" %}
                    <p><a href="#">{{user.profile.location}}</a></p>
                {% else %}
                    <p><a href="#">No location</a></p>
                {% endif %}
                <div class="followers">
                </div>
                <div class="stats-panel">
                    <div class="stat-item">
                        <span>Followers: <strong>{{user.profile.followers}}</strong></span>
                    </div>
                    <div class="stat-item">
                        <span>Following: <strong>{{user.profile.following}}</strong></span>
                    </div>
                    <div class="stat-item">
                        <span>Posts: <strong>{{tweets.count}}</strong></span>
                    </div>
                </div>
            </div>
        </div>
        {% if flag_posts %}
         {% for tweet in tweets %}
         <div class="post">
            <div class="post-author">
                <img src="{{ tweet.author.profile.image.url }}">
                <div>
                   <h1>{{tweet.author.username}}</h1>
                    <small>{{tweet.date_posted}}</small>
                </div>
            </div>
            {{tweet.content}}
            <div class="post-stats">
                <div>
                    <span>{{tweet.likes}} likes</span>
                </div>
            </div>
            <div class="post-activity">
                <div class="post-activity-link">
                    <img src="{% static 'img/like.png' %}" alt="">
                    <span>Like</span>
                </div>
                <div class="post-activity-link">
                    <img src="{% static 'img/share.png' %}" alt="">
                    <span>Share</span>
                </div>
            </div>
        </div>
        {% endfor %}
        {% endif %}
    </div>
        <div class="right-sidebar">
            <div class="subscriptions-panel">
                <h3>Your Followings</h3>
                <ul class="subscriptions-list">
                    {% for user in object_list %}
                    <li class="subscription-item">
                       <button onclick="location.href='/{{user.follow_user.username}}'" style="display: flex; align-items: center; border: none; background: none; cursor: pointer;">
                        <img style="width: 20px; height: 20px;" src="{{ user.follow_user.profile.image.url }}">
                        <span>{{ user.follow_user.username }}</span>
                        </button>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
<script>
    let profileMenu = document.getElementById("profileMenu");
    function toggleMenu(){
        profileMenu.classList.toggle("open-menu");
    }

    // Функция для открытия/закрытия меню профиля
    function toggleMenu() {
        var menu = document.getElementById("profileMenu");
        menu.classList.toggle("open-menu");
    }

    // Закрываем меню при клике вне его
    document.addEventListener("click", function(event) {
    var menu = document.getElementById("profileMenu");
    var profileImage = document.querySelector(".nav-profile-img");
    // Проверяем, если клик был за пределами меню и изображения профиля
    if (!menu.contains(event.target) && !profileImage.contains(event.target)) {
        menu.classList.remove("open-menu"); // Закрываем меню
    }
    });


    function autoResize(textarea) {
        textarea.style.height = 'auto'; // Сбрасываем высоту
        textarea.style.height = textarea.scrollHeight + 'px'; // Устанавливаем новую высоту
    }
    document.addEventListener("DOMContentLoaded", function() {
    const notificationButton = document.getElementById("notification-button");
    const notificationPopup = document.getElementById("notification-popup");

    // Функция для переключения видимости окна
    function toggleNotification() {
        notificationPopup.classList.toggle("show");
    }

    // Открываем/закрываем уведомления при клике на иконку
    notificationButton.addEventListener("click", function(event) {
        event.stopPropagation(); // Останавливаем всплытие события, чтобы клик по кнопке не закрывал окно
        toggleNotification();
    });

    // Закрываем уведомления при клике в любом другом месте страницы
    document.addEventListener("click", function(event) {
        // Проверяем, находится ли клик вне области окна с уведомлениями
        if (!notificationPopup.contains(event.target) && notificationPopup.classList.contains("show")) {
            notificationPopup.classList.remove("show");
        }
    });
});

</script>
</body>
